//
//  TempPassCodeVC.m
//  TrueClaim
//
//  Created by Krish on 22/07/14.
//  Copyright (c) 2014 KCSPL. All rights reserved.
//

#import "TempPassCodeVC.h"
#import "ApplicationData.h"
#import "RKPOPViewController.h"

@interface TempPassCodeVC ()

@end

@implementation TempPassCodeVC

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view.
    
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

-(void)viewWillAppear:(BOOL)animated
{
    _chk = false;

    _charCounter=0;
    _nullCharCounter=0;
    
    _l1.hidden=NO;
    _l1.hidden=NO;
    _l1.hidden=NO;
    _l1.hidden=NO;
    
    _i1.hidden=YES;
    _i2.hidden=YES;
    _i3.hidden=YES;
    _i4.hidden=YES;


    _tempTf = [[UITextField alloc] initWithFrame:CGRectZero];
    _tempTf.delegate=self;
    [self.view addSubview:_tempTf];
    [_tempTf becomeFirstResponder];
    [_tempTf setKeyboardType:UIKeyboardTypeNumberPad];

}

/*
#pragma mark - Navigation

// In a storyboard-based application, you will often want to do a little preparation before navigation
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    // Get the new view controller using [segue destinationViewController].
    // Pass the selected object to the new view controller.
}
*/

- (IBAction)btnCancel:(id)sender
{
        [self dismissViewControllerAnimated:YES completion:nil];
}


- (IBAction)btnSave:(id)sender
{
    [_tempTf resignFirstResponder];
    
    RKPOPViewController *rkPopSavePass = [[RKPOPViewController alloc] initWithNibName:@"RKPOPViewController" bundle:nil];
    rkPopSavePass.alertTitle = @"Passcode Saved!";
    rkPopSavePass.alertMessage = @"Please make sure you remember your 4 digit passcode.";
    rkPopSavePass.alertImage = [UIImage imageNamed:@"ios_tick_popup_icon.png"];
    
    rkPopSavePass.modalTransitionStyle = UIModalTransitionStyleCrossDissolve;
    [self presentViewController:rkPopSavePass animated:YES completion:nil];
}

- (void)alertView:(UIAlertView *)alertView didDismissWithButtonIndex:(NSInteger)buttonIndex
{
    // the user clicked OK
    if (buttonIndex == 0 && alertView.tag==5) {
        [self dismissViewControllerAnimated:YES completion:nil];

    }
}

- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string
{
    if ([string isEqualToString:@""])
    {
        switch (_charCounter)
        {
            case 1:
                _l1.hidden=NO;
                _i1.hidden=YES;_charCounter--;
                break;
                
            case 2:
                _l2.hidden=NO;
                _i2.hidden=YES;_charCounter--;
                break;
                
            case 3:
                _l3.hidden=NO;
                _i3.hidden=YES;_charCounter--;
                break;
                
            case 4:
                _l4.hidden=NO;
                _i4.hidden=YES;_charCounter--;
                break;
                
            default:
                _charCounter=0;
                break;
        }
        
        if (_charCounter<5)
        {
            _chk=false;
        }
        
    }
    else
    {
        
        if (_chk==false) {
            _charCounter++;
        }

        if (_charCounter==1)
        {
            _l1.hidden=YES;
            _i1.hidden=NO;
        }
        else if (_charCounter==2)
        {
            _l2.hidden=YES;
            _i2.hidden=NO;
        }
        else if (_charCounter==3)
        {
            _l3.hidden=YES;
            _i3.hidden=NO;
        }
        else if (_charCounter==4 && _chk==false)
        {
            _l4.hidden=YES;
            _i4.hidden=NO;
        }
        else if(_charCounter>4 || _chk==true)
        {
           UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Alert!"
                                                message:@"Already entered 4 digit"
                                               delegate:self
                                      cancelButtonTitle:@"OK"
                                      otherButtonTitles:nil];
                [alert show];
            _charCounter=4;
            _chk=true;
        }

    }
    
    
    return YES;
}
@end
